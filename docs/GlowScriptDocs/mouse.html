<!-- InstanceBegin template="/Templates/template.dwt" codeOutsideHTMLIsLocked="false" --><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>mouse and keyboard</title>
<!-- InstanceEndEditable -->
<!-- InstanceBeginEditable name="head" -->
<link href="VisualRef.css" rel="stylesheet" type="text/css" />
<!-- InstanceEndEditable -->
<link href="VisualRef.css" rel="stylesheet" type="text/css" />
</head>

<body>
<table width="230" height="30" border="0">
  <tr>
    <td width="66"><a name="top" id="top"></a><a href="index.html"><strong>Home</strong></a></td>
    <td width="154"><span class="Normal"><a href="primitives.html"><strong>Pictures</strong></a> of 3D objects</span></td>
  </tr>
</table>
<table width="438" height="30" border="0">
  <tr>
    <td width="151"><select id="menu1" onchange="jumpMenu(this)">
    </select></td>
    <td width="163"><select id="menu2" onchange="jumpMenu(this)">
    </select></td>
    <td width="110"><select id="menu3" onchange="jumpMenu(this)">
    </select></td>
  </tr>
</table>
<table width="454" border="0" cellpadding="0" cellspacing="0">
  <!--DWLayoutDefaultTable-->
  <tr>
    <td width="454" rowspan="2" valign="top"><!-- InstanceBeginEditable name="content" -->

        <h1 class="Heading-1"> <font color="#0000A0">Mouse and Keyboard Events</font><br />
        </h1>
<p class="Normal"><strong><font color="#0000A0">Introduction to events</font></strong></p>
<p class="Normal">You can wait for a mouse click, or for a key to be pressed or released (once the keyboard event problem is solved), with these statements:</p>
<p class="attributes"> <span class="attribute">scene.waitfor('click')</span> Wait for a mouse click. </p>
<p class="attributes"> <span class="attribute">scene.waitfor('keydown')</span> Wait for a key to be pressed.</p>
<p class="attributes"> <span class="attribute">scene.waitfor('keyup')</span> Wait for a key to be released.</p>
<p class="attributes"> <span class="attribute">scene.waitfor('keydown keyup')</span> Wait for a key press or release.</p>
<p class="Normal"> You can also set up a function to be called when a mouse or keyboard event occurs. The following will display the type of  event (mouse click or keydown) and, in the case of a keydown event, which key is involved:</p>
<p class="program">def process(event):<br />
&nbsp;&nbsp;&nbsp;&nbsp;print(event.event, event.which)<br />
  <br />
  scene.bind('click keydown', process)</p>
<p class="Normal">The quantity <span class="attribute">event.event</span> will be 'keydown' if a key was pressed or 'mousedown' if the left mouse button was pressed. The quantity <span class="attribute">event.which</span> is the numerical key code or mouse button indicator (mouse button is always 1 for now). For example, <span class="attribute">event.which</span> is 65 for the 'a' key. The quantity <span class="attribute">event.key</span> is the corresponding character string, such as 'a' or 'delete'. </p>
<p class="Normal">The quantity <span class="attribute">event.canvas</span> is the canvas associated with the event. You can bind events on different canvases to the same function and be able to tell in which canvas the event occurred.</p>
<p class="Normal">Note  that <span class="attribute">scene.mouse.shift</span> is true if the shift key is down at the time of the keyboard event; similarly for <span class="attribute">scene.mouse.ctrl</span> and <span class="attribute">scene.mouse.alt</span>.</p>
<p class="Normal">In RapydScript it is possible to use &quot;anonymous&quot; (unnamed) functions in this situation. For examples, see the <strong><a href="mouse_drag.html" target="_blank">mouse drag</a></strong> discussion.</p>
<p class="Normal"></p>
<p class="Normal">JavaScript version::</p>
<p class="program">var process = function(event) {<br />
  &nbsp;&nbsp;&nbsp;&nbsp;print(event.type, event.which)<br />
  }
  <br />
  <br />
  scene.bind('click keydown', process)</p>
<p class="Normal"><strong><font color="#0000A0">More on mouse events</font></strong></p>
        <p class="Normal"> Mouse objects are obtained from the mouse attribute of a 
          canvas object such as <span class="attribute">scene</span>. For example, 
          to obtain mouse input from the default window created by GlowScript, refer to the object  <span class="attribute">scene.mouse.</span> For specific examples of mouse handling, 
          see <a href="mouse_click.html"><strong>Click example</strong></a> and <a href="mouse_drag.html"><strong>Drag 
          example</strong></a>. A mouse object has a group of attributes corresponding to 
  the current state of the mouse.</p>
        <p class="Normal">The simplest mouse interaction is to wait for a mouse click:</p>
        <p class="attributes"> <span class="attribute">scene.pause()</span> An icon is displayed in the canvas to indicate a pause, waiting for a mouse click.        </p>
        <p class="attributes"> <span class="attribute">scene.pause(&quot;Click to proceed&quot;)</span> The specified text is displayed in the canvas to indicate a pause, waiting for a mouse click.        </p>
        <p class="Normal">You can also wait for mouse interactions without displaying a prompt:</p>
      <p class="attributes"> <span class="attribute">scene.waitfor(&quot;click&quot;)</span> Wait for the mouse button to be depressed and then released</p>
        <p class="attributes"><span class="attribute">scene.waitfor(&quot;mousedown&quot;)</span> Wait for the mouse button to be depressed</p>
        <p class="attributes"><span class="attribute">scene.waitfor(&quot;mousemove&quot;)</span> Wait for the mouse to move, whether or not the mouse button is depressed</p>
      <p class="attributes"><span class="attribute">scene.waitfor(&quot;mouseup&quot;)</span> Wait for the mouse button to be released</p>
      <p class="attributes"><span class="attribute">scene.waitfor(&quot;mouseenter&quot;)</span> Wait for the mouse to move, whether or not the mouse button is depressed</p>
      <p class="attributes"><span class="attribute">scene.waitfor(&quot;mouseleave&quot;)</span> Wait for the mouse button to be released</p>
      <p class="Normal">Here are waitfor options to wait for canvas updates:</p>
        <p class="attributes"><span class="attribute">scene.waitfor(&quot;redraw&quot;) </span>Wait for the start of the next update of the canvas by the web browser</p>
        <p class="attributes"><span class="attribute">scene.waitfor(&quot;draw_complete&quot;) </span>Wait for the end of the next update of the canvas by the web browser</p>
        <p class="Normal">It is a useful debugging technique to insert <span class="attribute">scene.pause()</span> into your program at a point where you would like to stop temporarily to examine 
      the scene. Then just click to proceed.        </p>
        <p class="Normal"><strong>Multiple event types:</strong> You can wait for more than one type of event. The following statement will wait for either the mouse entering the canvas or leaving the canvas:</p>
        <p class="program">scene.waitfor(&quot;mouseenter mouseleave&quot;)</p>
        <p class="Normal">In the  <a href="mouse_drag.html">Drag 
        example</a> you will see how to use event-handling functions to process mouse events continuously.</p>
      <p class="Normal"><strong> <font color="#0000A0">Current state of mouse and control keys</font></strong></p>
        <p class="attributes"> <span class="attribute">pos</span> The current 3D position 
          of the mouse cursor; <span class="attribute">scene.mouse.pos</span>. GlowScript 
          always chooses a point in the plane parallel to the screen and passing through <span class="attribute">canvas.center</span>. (See <a href="#alternative">Projecting 
            mouse information onto a given plane</a> for other options.)        </p>
        <p class="attributes"> <span class="attribute">ray</span> A unit vector pointing 
          from camera in the direction of the mouse cursor. The points under the mouse 
          cursor are exactly {<span class="attribute"> scene.camera.pos + t*scene.mouse.ray</span> for <span class="attribute">t&gt;0</span>}.</p>
        <p class="attributes"><span class="attribute">project()</span> Projects position 
          onto a plane. See <a href="#alternative">Projecting mouse position onto a given 
            plane</a>. </p>
        <p class="attributes"><span class="attribute">pick()</span> Execute <span class="attribute">var obj = scene.mouse.pick()</span> to obtain the object pointed to by the mouse. If you have a box named <span class="attribute">B</span>, you can determine whether the picked object is that box by asking <span class="attribute">if (B == obj)</span>. If there is no object pointed to by the mouse, <span class="attribute">obj</span> is <span class="attribute">null</span>. Also, <span class="attribute">obj</span> will be <span class="attribute">null</span> if the object has the  <span class="attribute">pickable</span> attribute set to <span class="attribute">false</span>. For example, the curves, spheres, and arrows created by attach_trail and attach_arrow are not pickable, and you may wish to specify that some of your own objects are not pickable. Label objects are never pickable. For curve objects, <span class="attribute">obj.segment</span> is the number of the picked segment along the curve, starting with 1 (representing the segment from point number 0 to point number 1). You can test for a curve object with<span class="attribute"> if (obj.constructor == curve)</span>. See the GlowScript example <a href="http://www.glowscript.org/#/user/GlowScriptDemos/folder/Examples/program/MousePicking" target="_blank">MousePicking</a>.      </p>
        <p class="attributes"><span class="attribute">alt</span> The quantity <span class="attribute">scene.mouse.alt</span> is true if the ALT key 
          is currently down (Mac Options key), otherwise false</p>
        <p class="attributes"><span class="attribute">ctrl</span> The quantity <span class="attribute">scene.mouse.ctrl</span> is true if the CTRL key 
          is currently down, otherwise false</p>
        <p class="attributes"><span class="attribute">shift </span>The quantity <span class="attribute">scene.mouse.shift</span> is true if the SHIFT 
          key is currently down, otherwise false</p>
        <p class="Normal">Note that if <span class="attribute">scene.userzoom = true</span> you won't see mouse events with the ALT key down, and if <span class="attribute">scene.userspin = true</span> you won't see mouse events with the CTRL key down.</p>
<p class="Normal"><font color="#0000A0"><a name="alternative" id="alternative"></a><strong>Projecting 
          mouse position onto a given plane</strong></font></p>
        <p class="Normal"> Here is a way to get the mouse position relative to a particular 
          plane in space:</p>
        <p class="program"> temp = scene.mouse.project(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          normal=vec(0,1,0),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point=vec(0,3,0) )<br />
          # null if no intersection with plane:<br />
        if temp != null) ball.pos = temp</p>
        <p class="Normal"> This projects the mouse cursor onto a plane that is perpendicular 
          to the specified normal. If the second parameter is not 
          specified, the plane passes through the origin. It returns a 3D position, 
          or null if the projection of the mouse misses the plane (scene.mouse.ray is parallel to the plane).</p>
        <p class="Normal"> In the example shown above, the user of your program will 
          be able to use the mouse to place balls in a plane parallel to the xy plane, 
          a height of 3 above the xy plane, no matter how the user has rotated the point 
          of view.</p>
        <p class="Normal">You can instead specify a perpendicular distance from the origin to the plane that is perpendicular to the specified normal. 
        The example above is equivalent to</p>
        <p class="program"> temp=scene.mouse.project(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal=vec(0,1,0),
d=3 )</p>
    <!-- InstanceEndEditable --></td>
  </tr>
</table>
<p><a href="#top"><strong>Top of page</strong></a></p>
</body>
<script type="text/javascript" language="javascript" src="navigation.js"></script>
<!-- InstanceEnd --></html>
